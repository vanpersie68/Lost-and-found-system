{"ast":null,"code":"import { getMyDoorList, setMyDoorList, userInfoEdit } from \"./api.js\";\nimport uploadPicThumb from \"@/views/template/upload-pic-thumb\";\nimport Cookies from \"js-cookie\";\nimport dict from \"@/views/template/dict\";\nimport search from \"./search.vue\";\nexport default {\n  components: {\n    uploadPicThumb,\n    dict,\n    search\n  },\n  name: \"my_home_index\",\n  data() {\n    return {\n      editFlag: false,\n      userForm: {\n        id: \"\",\n        avatar: \"\",\n        username: \"\",\n        sex: \"\",\n        status: \"\",\n        type: \"\",\n        typeTxt: \"\",\n        address: \"\",\n        addressArray: []\n      },\n      saveLoading: false,\n      addMenuTempList: []\n    };\n  },\n  methods: {\n    init() {\n      let v = JSON.parse(Cookies.get(\"userInfo\"));\n      for (let attr in v) {\n        if (v[attr] == null) {\n          v[attr] = \"\";\n        }\n      }\n      let str = JSON.stringify(v);\n      let userInfo = JSON.parse(str);\n      userInfo.addressArray = [];\n      this.userForm = userInfo;\n      if (userInfo.address) {\n        this.userForm.address = userInfo.address;\n        this.userForm.addressArray = JSON.parse(userInfo.address);\n      }\n      if (this.userForm.type == 0) {\n        this.userForm.typeTxt = \"General user\";\n      } else if (this.userForm.type == 1) {\n        this.userForm.typeTxt = \"Administrator\";\n      }\n    },\n    addMenuTempFx(e) {\n      if (this.addMenuTempList.length > 5) {\n        this.$Message.warning(\"Add up to 6 commonly used modules\");\n      } else {\n        this.addMenuTempList.push(e);\n      }\n    },\n    addMenuFx() {\n      var str = \"\";\n      var size = this.addMenuTempList.length;\n      if (size > 0) {\n        str += this.addMenuTempList[0].name;\n        for (var i = 1; i < size; i++) {\n          str += \"ZWZ666\" + this.addMenuTempList[i].name;\n        }\n      }\n      setMyDoorList({\n        str: str\n      }).then(res => {\n        if (res.success) {\n          this.$Message.warning(\"Successful operation\");\n        }\n      });\n    },\n    saveEdit() {\n      this.saveLoading = true;\n      this.editFlag = false;\n      if (typeof this.userForm.birth == \"object\") {\n        this.userForm.birth = this.format(this.userForm.birth, \"yyyy-MM-dd\");\n      }\n      delete this.userForm.roles;\n      userInfoEdit(this.userForm).then(res => {\n        this.saveLoading = false;\n        if (res.success) {\n          this.$Message.success(\"Saved successfully\");\n          // 更新用户信息\n          Cookies.set(\"userInfo\", JSON.stringify(this.userForm));\n          // 更新头像\n          this.$store.commit(\"setAvatarPath\", this.userForm.avatar);\n        }\n      });\n    },\n    getMyDoorListFx() {\n      var that = this;\n      getMyDoorList().then(res => {\n        that.addMenuTempList = res.result;\n      });\n    },\n    deleteOneMenu(e) {\n      var array = [];\n      for (var i = 0; i < this.addMenuTempList.length; i++) {\n        if (this.addMenuTempList[i].name != e.name) {\n          array.push(this.addMenuTempList[i]);\n        }\n      }\n      this.addMenuTempList = array;\n    },\n    changeAddress() {\n      this.userForm.address = JSON.stringify(this.userForm.addressArray);\n    },\n    changeBirth(v) {\n      this.userForm.birth = v;\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};","map":{"version":3,"names":["getMyDoorList","setMyDoorList","userInfoEdit","uploadPicThumb","Cookies","dict","search","components","name","data","editFlag","userForm","id","avatar","username","sex","status","type","typeTxt","address","addressArray","saveLoading","addMenuTempList","methods","init","v","JSON","parse","get","attr","str","stringify","userInfo","addMenuTempFx","e","length","$Message","warning","push","addMenuFx","size","i","then","res","success","saveEdit","birth","format","roles","set","$store","commit","getMyDoorListFx","that","result","deleteOneMenu","array","changeAddress","changeBirth","mounted"],"sources":["src/views/home/myHome.vue"],"sourcesContent":["<template>\n<div class=\"own-space\">\n    <Card>\n        <Divider dashed>\n            Personal portal\n            <Button type=\"success\" v-show=\"!editFlag\" @click=\"editFlag = true\">Start editing</Button>\n            <Button type=\"warning\" v-show=\"editFlag\" @click=\"saveEdit\">Save submission</Button>\n        </Divider>\n        <Form ref=\"userForm\" :model=\"userForm\" :label-width=\"90\" label-position=\"left\">\n            <Row :gutter=\"16\">\n                <Col :span=\"12\">\n                <FormItem label=\"Login account\" prop=\"username\">\n                    <Input v-model=\"userForm.username\" readonly style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n                <Col :span=\"12\">\n                <FormItem label=\"Name\" prop=\"nickname\">\n                    <Input v-model=\"userForm.nickname\" readonly style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n            </Row>\n            <Row :gutter=\"16\">\n                <Col :span=\"12\">\n                <FormItem label=\"Account type\" prop=\"typeTxt\">\n                    <Input v-model=\"userForm.typeTxt\" readonly style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n                <Col :span=\"12\">\n                <FormItem label=\"Department\" prop=\"departmentTitle\">\n                    <Input v-model=\"userForm.departmentTitle\" readonly style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n            </Row>\n            <Row :gutter=\"16\">\n                <Col :span=\"12\">\n                <FormItem label=\"Gender\" prop=\"username\">\n                    <dict dict=\"sex\" v-model=\"userForm.sex\" transfer :readonly=\"!editFlag\" placeholder=\"Please select gender\" style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n                <Col :span=\"12\">\n                <FormItem label=\"Avatar\" prop=\"avatar\">\n                    <upload-pic-thumb v-model=\"userForm.avatar\" :multiple=\"false\" style=\"width: 100%\"></upload-pic-thumb>\n                </FormItem>\n                </Col>\n            </Row>\n            <Row :gutter=\"16\">\n                <Col :span=\"12\">\n                <FormItem label=\"Family address\" prop=\"nickname\">\n                    <Input v-model=\"userForm.street\" :readonly=\"!editFlag\" style=\"width: 100%\" />\n                </FormItem>\n                </Col>\n                <Col :span=\"12\">\n                <FormItem label=\"Birthday\" prop=\"username\">\n                    <DatePicker v-model=\"userForm.birth\" @on-change=\"changeBirth\" :readonly=\"!editFlag\" style=\"width: 100%\" type=\"date\"></DatePicker>\n                </FormItem>\n                </Col>\n            </Row>\n            <Row :gutter=\"16\">\n                <Col :span=\"24\">\n                <FormItem label=\"Signature\" prop=\"nickname\">\n                    <Input v-model=\"userForm.description\" type=\"textarea\" :readonly=\"!editFlag\" style=\"width: 100%\" :autosize=\"{minRows: 3,maxRows: 5}\" placeholder=\"Signature\"></Input>\n                </FormItem>\n                </Col>\n            </Row>\n        </Form>\n    </Card>\n    <Divider>Personal portal</Divider>\n    <Card>\n        <Row :gutter=\"16\">\n            <Col span=\"12\">\n            <Divider>Currently commonly used modules</Divider>\n            <List header=\"---\" footer=\"---\" border>\n                <ListItem v-for=\"(item, index) in addMenuTempList\" :key=\"index\">\n                    {{ item.title }}\n                    <Button @click=\"deleteOneMenu(item)\" type=\"error\" shape=\"circle\" icon=\"md-trash\" size=\"small\" style=\"marginLeft:20px;\"></Button>\n                </ListItem>\n            </List>\n            </Col>\n            <Col span=\"12\">\n            <Divider>Personal portal settings\n                <Button @click=\"addMenuFx\" type=\"primary\">Save changes</Button></Divider>\n            <Row :gutter=\"16\">\n                <div class=\"desc\">Complete the selection menu below to add</div>\n                <search theme=\"light\" type=\"input\" @changeOk=\"addMenuTempFx\" />\n            </Row>\n            </Col>\n        </Row>\n    </Card>\n</div>\n</template>\n\n<script>\nimport {\n    getMyDoorList,\n    setMyDoorList,\n    userInfoEdit\n} from \"./api.js\";\nimport uploadPicThumb from \"@/views/template/upload-pic-thumb\";\nimport Cookies from \"js-cookie\";\nimport dict from \"@/views/template/dict\";\nimport search from \"./search.vue\";\nexport default {\n    components: {\n        uploadPicThumb,\n        dict,\n        search\n    },\n    name: \"my_home_index\",\n    data() {\n        return {\n            editFlag: false,\n            userForm: {\n                id: \"\",\n                avatar: \"\",\n                username: \"\",\n                sex: \"\",\n                status: \"\",\n                type: \"\",\n                typeTxt: \"\",\n                address: \"\",\n                addressArray: []\n            },\n            saveLoading: false,\n            addMenuTempList: []\n        };\n    },\n    methods: {\n        init() {\n            let v = JSON.parse(Cookies.get(\"userInfo\"));\n            for (let attr in v) {\n                if (v[attr] == null) {\n                    v[attr] = \"\";\n                }\n            }\n            let str = JSON.stringify(v);\n            let userInfo = JSON.parse(str);\n            userInfo.addressArray = [];\n            this.userForm = userInfo;\n            if (userInfo.address) {\n                this.userForm.address = userInfo.address;\n                this.userForm.addressArray = JSON.parse(userInfo.address);\n            }\n            if (this.userForm.type == 0) {\n                this.userForm.typeTxt = \"General user\";\n            } else if (this.userForm.type == 1) {\n                this.userForm.typeTxt = \"Administrator\";\n            }\n        },\n        addMenuTempFx(e) {\n            if (this.addMenuTempList.length > 5) {\n                this.$Message.warning(\"Add up to 6 commonly used modules\");\n            } else {\n                this.addMenuTempList.push(e);\n            }\n        },\n\n        addMenuFx() {\n            var str = \"\";\n            var size = this.addMenuTempList.length;\n            if (size > 0) {\n                str += this.addMenuTempList[0].name;\n                for (var i = 1; i < size; i++) {\n                    str += \"ZWZ666\" + this.addMenuTempList[i].name;\n                }\n            }\n            setMyDoorList({\n                str: str\n            }).then((res) => {\n                if (res.success) {\n                    this.$Message.warning(\"Successful operation\");\n                }\n            });\n        },\n        saveEdit() {\n            this.saveLoading = true;\n            this.editFlag = false;\n            if (typeof this.userForm.birth == \"object\") {\n                this.userForm.birth = this.format(this.userForm.birth, \"yyyy-MM-dd\");\n            }\n            delete this.userForm.roles;\n            userInfoEdit(this.userForm).then(res => {\n                this.saveLoading = false;\n                if (res.success) {\n                    this.$Message.success(\"Saved successfully\");\n                    // 更新用户信息\n                    Cookies.set(\"userInfo\", JSON.stringify(this.userForm));\n                    // 更新头像\n                    this.$store.commit(\"setAvatarPath\", this.userForm.avatar);\n                }\n            });\n        },\n\n        getMyDoorListFx() {\n            var that = this;\n            getMyDoorList().then((res) => {\n                that.addMenuTempList = res.result;\n            });\n        },\n        deleteOneMenu(e) {\n            var array = [];\n            for (var i = 0; i < this.addMenuTempList.length; i++) {\n                if (this.addMenuTempList[i].name != e.name) {\n                    array.push(this.addMenuTempList[i]);\n                }\n            }\n            this.addMenuTempList = array;\n        },\n        changeAddress() {\n            this.userForm.address = JSON.stringify(this.userForm.addressArray);\n        },\n        changeBirth(v) {\n            this.userForm.birth = v;\n        }\n    },\n    mounted() {\n        this.init();\n    }\n};\n</script>\n\n<style lang=\"less\" scoped>\n\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}