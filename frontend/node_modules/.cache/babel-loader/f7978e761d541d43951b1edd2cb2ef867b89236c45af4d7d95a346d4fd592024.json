{"ast":null,"code":"import { login, userInfo, initCaptcha, drawCodeImage } from \"@/api/index\";\nimport Cookies from \"js-cookie\";\nimport util from \"@/libs/util.js\";\nexport default {\n  components: {},\n  data() {\n    return {\n      saoMaFx: false,\n      captchaId: \"\",\n      captchaImg: \"\",\n      loadingCaptcha: false,\n      error: false,\n      tabName: \"userAndPassword\",\n      saveLogin: true,\n      loading: false,\n      form: {\n        username: \"admin\",\n        password: \"123456\",\n        mobile: \"\",\n        code: \"\"\n      },\n      usernameLoginFormRules: {\n        username: [{\n          required: true,\n          message: \"Username cannot be empty\",\n          trigger: \"blur\"\n        }],\n        password: [{\n          required: true,\n          message: \"Password cannot be empty\",\n          trigger: \"blur\"\n        }],\n        imgCode: [{\n          required: true,\n          message: \"Verification code cannot be empty\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  methods: {\n    getCaptchaImg() {\n      this.loadingCaptcha = true;\n      initCaptcha().then(res => {\n        this.loadingCaptcha = false;\n        if (res.success) {\n          this.captchaId = res.result;\n          this.captchaImg = drawCodeImage + this.captchaId;\n        }\n      });\n    },\n    changeTabName(e) {\n      if (e != \"userAndPassword\") {\n        window.WwLogin({\n          \"id\": \"qywxsmqywxsm\",\n          \"appid\": \"wwf94bb44e76e308f8\",\n          \"agentid\": \"1000002\",\n          \"redirect_uri\": \"https://artskyhome.com:8080/%23/login\",\n          \"state\": \"ZWZ1314520\",\n          \"href\": \"\"\n        });\n      }\n    },\n    afterLogin(res) {\n      let accessToken = res.result;\n      this.setStore(\"accessToken\", accessToken);\n      userInfo().then(res => {\n        if (res.success) {\n          delete res.result.permissions;\n          let roles = [];\n          res.result.roles.forEach(e => {\n            roles.push(e.name);\n          });\n          delete res.result.roles;\n          this.setStore(\"roles\", roles);\n          this.setStore(\"saveLogin\", this.saveLogin);\n          if (this.saveLogin) {\n            Cookies.set(\"userInfo\", JSON.stringify(res.result), {\n              expires: 7\n            });\n          } else {\n            Cookies.set(\"userInfo\", JSON.stringify(res.result));\n          }\n          this.setStore(\"userInfo\", res.result);\n          this.$store.commit(\"setAvatarPath\", res.result.avatar);\n          util.initRouter(this);\n          this.$router.push({\n            name: \"home_index\"\n          });\n        } else {\n          this.loading = false;\n        }\n      });\n    },\n    submitLogin() {\n      this.$refs.usernameLoginForm.validate(valid => {\n        if (valid) {\n          this.loading = true;\n          login({\n            username: this.form.username,\n            password: this.form.password,\n            code: this.form.imgCode,\n            captchaId: this.captchaId,\n            saveLogin: this.saveLogin\n          }).then(res => {\n            if (res.success) {\n              this.afterLogin(res);\n            } else {\n              this.loading = false;\n              this.getCaptchaImg();\n            }\n          });\n        }\n      });\n    }\n  },\n  mounted() {\n    this.getCaptchaImg();\n  }\n};","map":{"version":3,"names":["login","userInfo","initCaptcha","drawCodeImage","Cookies","util","components","data","saoMaFx","captchaId","captchaImg","loadingCaptcha","error","tabName","saveLogin","loading","form","username","password","mobile","code","usernameLoginFormRules","required","message","trigger","imgCode","methods","getCaptchaImg","then","res","success","result","changeTabName","e","window","WwLogin","afterLogin","accessToken","setStore","permissions","roles","forEach","push","name","set","JSON","stringify","expires","$store","commit","avatar","initRouter","$router","submitLogin","$refs","usernameLoginForm","validate","valid","mounted"],"sources":["src/views/login.vue"],"sourcesContent":["<template>\n    <div class=\"login\">\n      <Row justify=\"center\" align=\"middle\" @keydown.enter.native=\"submitLogin\" style=\"height:100%\">\n        <div class=\"loginUp\">\n          <div class=\"loginLeft\">\n            <img src=\"../assets/login/logo.png\" alt=\"\" srcset=\"\">\n            <span class=\"line\"></span>\n            <span class=\"title\">Campus Lost and Found Management System</span>\n          </div>\n        </div>\n        <div class=\"loginMiddle\">\n          <div class=\"login-background\">\n            <div class=\"loginBg\"></div>\n            <div class=\"loginRight\">\n              <Row class=\"loginRow\">\n                <Tabs v-model=\"tabName\" @on-click=\"changeTabName\" class=\"loginTab\">\n                  <TabPane label=\"Username and Password Login\" name=\"userAndPassword\">\n                    <Form ref=\"usernameLoginForm\" :model=\"form\" :rules=\"usernameLoginFormRules\" class=\"form\">\n                      <FormItem prop=\"username\" class=\"loginInput\">\n                        <Row>\n                          <Input v-model=\"form.username\" size=\"large\" clearable placeholder=\"Username\" autocomplete=\"off\">\n                            <Icon class=\"iconfont icon-yonghu\" slot=\"prefix\" style=\"line-height:50px\" />\n                          </Input>\n                        </Row>\n                      </FormItem>\n                      <FormItem prop=\"password\">\n                        <Input style=\"height:50px;line-height:50px\" type=\"password\" v-model=\"form.password\" size=\"large\" placeholder=\"Enter Password\" password autocomplete=\"off\">\n                          <Icon class=\"iconfont icon-mima1\" slot=\"prefix\" style=\"line-height:50px\" />\n                        </Input>\n                      </FormItem>\n                      <FormItem prop=\"imgCode\">\n                        <Row type=\"flex\" justify=\"space-between\" style=\"align-items: center;overflow: hidden;\">\n                          <Input v-model=\"form.imgCode\" size=\"large\" clearable placeholder=\"Enter Verification Code\" :maxlength=\"10\" class=\"input-verify\" />\n                          <div class=\"code-image\" style=\"position:relative;font-size:12px;\">\n                            <Spin v-if=\"loadingCaptcha\" fix></Spin>\n                            <img :src=\"captchaImg\" @click=\"getCaptchaImg\" alt=\"Failed to Load Verification Code\" style=\"width:110px;cursor:pointer;display:block\" />\n                          </div>\n                        </Row>\n                      </FormItem>\n                    </Form>\n                    <Row type=\"flex\" justify=\"space-between\" align=\"middle\">\n                      <Checkbox v-model=\"saveLogin\" size=\"large\">Remember Me</Checkbox>\n                      <router-link to=\"/regist\">\n                        <a class=\"forget-pass\">Don't have an account? Register here</a>\n                      </router-link>\n                    </Row>\n                    <Row>\n                      <Button class=\"login-btn\" type=\"primary\" size=\"large\" :loading=\"loading\" @click=\"submitLogin\" long>\n                        <span v-if=\"!loading\" style=\"letter-spacing:20px; font-weight:bold\">Login</span>\n                        <span v-else>Loading... Please wait</span>\n                      </Button>\n                    </Row>\n                  </TabPane>\n                  <TabPane label=\"Enterprise WeChat Scan\" name=\"mobile\">\n                    <div id=\"qywxsmqywxsm\"></div>\n                  </TabPane>\n                </Tabs>\n              </Row>\n              <p class=\"loginBottom\">\n                ART YOUR DREAM\n              </p>\n            </div>\n          </div>\n        </div>\n        <div class=\"loginDown\">\n          <p style=\"margin-top:10px\">Help | Privacy | Terms</p>\n          <p>\n            <span>Copyright © 2020 - Present XXX. All rights reserved</span>\n            <span style=\"display:inline-block; width:4px;height:6px\"></span>\n            <a target=\"_blank\" href=\"https://beian.miit.gov.cn\" style=\"color:#848585\">ICP Record Zhejiang ICP No. XXXXXXXX</a>\n            <a target=\"_blank\" href=\"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=XXXXXXXXXXXXXX号\">\n              <img src=\"../assets/login/gonganlogo.png\" style=\"margin-left:6px\" />\n              <p style=\"display:inline-block;color:#848585\">Zhejiang Public Network Security No. XXXXXXXXXXXXXX号</p>\n            </a>\n          </p>\n        </div>\n      </Row>\n    </div>\n  </template>\n  \n  <script>\n  import {\n    login,\n    userInfo,\n    initCaptcha,\n    drawCodeImage\n  } from \"@/api/index\";\n  import Cookies from \"js-cookie\";\n  import util from \"@/libs/util.js\";\n  export default {\n    components: {\n    },\n    data() {\n      return {\n        saoMaFx: false,\n        captchaId: \"\",\n        captchaImg: \"\",\n        loadingCaptcha: false,\n        error: false,\n        tabName: \"userAndPassword\",\n        saveLogin: true,\n        loading: false,\n        form: {\n          username: \"admin\",\n          password: \"123456\",\n          mobile: \"\",\n          code: \"\"\n        },\n        usernameLoginFormRules: {\n          username: [{\n            required: true,\n            message: \"Username cannot be empty\",\n            trigger: \"blur\"\n          }],\n          password: [{\n            required: true,\n            message: \"Password cannot be empty\",\n            trigger: \"blur\"\n          }],\n          imgCode: [{\n            required: true,\n            message: \"Verification code cannot be empty\",\n            trigger: \"blur\"\n          }]\n        }\n      };\n    },\n    methods: {\n      getCaptchaImg() {\n        this.loadingCaptcha = true;\n        initCaptcha().then(res => {\n          this.loadingCaptcha = false;\n          if (res.success) {\n            this.captchaId = res.result;\n            this.captchaImg = drawCodeImage + this.captchaId;\n          }\n        });\n      },\n      changeTabName(e) {\n        if (e != \"userAndPassword\") {\n          window.WwLogin({\n            \"id\": \"qywxsmqywxsm\",\n            \"appid\": \"wwf94bb44e76e308f8\",\n            \"agentid\": \"1000002\",\n            \"redirect_uri\": \"https://artskyhome.com:8080/%23/login\",\n            \"state\": \"ZWZ1314520\",\n            \"href\": \"\",\n          });\n        }\n      },\n      afterLogin(res) {\n        let accessToken = res.result;\n        this.setStore(\"accessToken\", accessToken);\n        userInfo().then((res) => {\n          if (res.success) {\n            delete res.result.permissions;\n            let roles = [];\n            res.result.roles.forEach((e) => {\n              roles.push(e.name);\n            });\n            delete res.result.roles;\n            this.setStore(\"roles\", roles);\n            this.setStore(\"saveLogin\", this.saveLogin);\n            if (this.saveLogin) {\n              Cookies.set(\"userInfo\", JSON.stringify(res.result), {\n                expires: 7,\n              });\n            } else {\n              Cookies.set(\"userInfo\", JSON.stringify(res.result));\n            }\n            this.setStore(\"userInfo\", res.result);\n            this.$store.commit(\"setAvatarPath\", res.result.avatar);\n            util.initRouter(this);\n            this.$router.push({\n              name: \"home_index\",\n            });\n          } else {\n            this.loading = false;\n          }\n        });\n      },\n      submitLogin() {\n        this.$refs.usernameLoginForm.validate(valid => {\n          if (valid) {\n            this.loading = true;\n            login({\n              username: this.form.username,\n              password: this.form.password,\n              code: this.form.imgCode,\n              captchaId: this.captchaId,\n              saveLogin: this.saveLogin\n            }).then(res => {\n              if (res.success) {\n                this.afterLogin(res);\n              } else {\n                this.loading = false;\n                this.getCaptchaImg();\n              }\n            });\n          }\n        });\n      }\n    },\n    mounted() {\n      this.getCaptchaImg();\n    }\n  };\n  </script>\n  \n  <style lang=\"less\">\n  html,body{\n    background: #ffffff !important;\n    font-family: Microsoft YaHei;\n    font-weight: 400;;\n  }\n  a{   \n    font-family: Microsoft YaHei;\n    color: #77C8C6;\n  }\n  input::-webkit-input-placeholder {\n    font-size: 14px;\n  }\n  .ivu-checkbox-wrapper.ivu-checkbox-large{\n    font-size: 14px;\n  }\n  a:hover{\n    font-family: Microsoft YaHei;\n    color: #77C8C6;\n  }\n  .login {\n    height: 100%;\n    background-color: #ffffff;\n  \n    .ivu-tabs-nav-container {\n      line-height: 2;\n      font-size: 17px;\n      box-sizing: border-box;\n      white-space: nowrap;\n      overflow: hidden;\n      position: relative;\n      zoom: 1;\n    }\n    .loginUp{\n      width: 1200px;\n      min-height: 80px;\n      background-color:#ffffff;\n      margin: 0 auto;\n      overflow: hidden;\n    }\n    .loginLeft{\n      margin-top: 20px;\n      height: 50px;\n      display: flex;\n    }\n    .line{\n      display: inline-block;\n      width: 2px;\n      height: 25px;\n      background: url(../assets/login/line.png);\n      margin: 0px 10px;\n      margin-top: 15px;\n    }\n    .title{\n      line-height: 58px; \n      font-size: 18px;\n      font-family: Microsoft YaHei;\n      font-weight: 500;\n      color: #999999;\n    }\n    .loginMiddle{\n      width: 100%;\n      height: 780px;\n      margin: 0 auto; \n      background-color: #6a6ad2;\n      overflow: hidden;\n      // background: linear-gradient(45deg, rgba(2, 173, 168, 0.17), rgba(0, 221, 215, 0.17)); \n    }     \n    .login-background{\n      width: 1200px;\n      height: 780px;\n      margin: 0 auto;   \n      display: flex;\n      justify-content: space-between;\n    }\n    .loginBg{\n      width: 560px;\n      height: 684px;\n      margin-top: -20px;\n      background-image: url(../assets/login/star.png);\n      background-repeat: no-repeat;\n      background-position: left bottom;\n    }\n    .loginRight{\n      width: 450px;\n      height: 550px;\n      background-color: #ffffff;\n      border: 1px solid #E6E6E6;\n      box-shadow: 0px 2px 15px 1px rgba(0, 0, 0, 0.1);\n      border-radius: 5px;\n      margin-top: 115px;\n      position: relative;\n    }\n    .loginRow{\n      padding: 0px 30px;\n    }\n    .loginDown{\n      width: 1200px;\n      height: auto;\n      margin: 0 auto;\n    }\n    .loginTab{\n      margin-top: 20px;\n    }\n    .ivu-tabs-tab{\n      color: #333333;     \n      font-size: 18px;\n      font-family: Microsoft YaHei;\n      font-weight: bold;\n    }\n    .ivu-tabs-nav .ivu-tabs-tab{\n      padding: 8px 42px;\n      margin-right: 0px;\n    }\n    .ivu-tabs-ink-bar{\n      height: 4px;\n      width: 86px !important;\n      border-radius: 2px;\n      margin: 0px 42px;\n      background-color: #6a6ad2;\n    }\n    .ivu-tabs-nav .ivu-tabs-tab-active,.ivu-tabs-nav .ivu-tabs-tab:hover{\n      color: #333333;   \n    }\n    .loginInput{\n      font-size: 18px;    \n      font-family: Microsoft YaHei;\n      font-weight: bold;\n      color: #333333;\n    }\n  \n    .ivu-tabs-bar{\n      border-bottom: 0px;\n    }\n    .login-btn{\n      width: 390px;\n      height: 50px;\n      background: radial-gradient(circle, #2f2fde, #7c3897);\n      border: 2px solid #61C8C5;\n      box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.21);\n      border-radius: 4px;\n    }\n    .login .login-btn, .login .other-login{\n      margin-top: 40px;\n    }\n    .loginBottom{\n      width: 448px;\n      height: 60px;      \n      background: #f9f9f9;\n      border-radius: 0px 0px 5px 5px;\n      padding: 0px;\n      position: absolute;\n      bottom: 0px;  \n      font-size: 16px;\n      font-weight: bold;\n      color: #6a6ad2;\n      text-align: center;\n      line-height: 60px;\n    }\n    .loginDown p{\n      text-align: center;       \n      font-size: 12px;\n      font-family: Microsoft YaHei;\n      color: #777777;\n      line-height: 22px;\n    }\n    .ivu-checkbox-checked .ivu-checkbox-inner{\n      background-color: #6a6ad2;\n      border-color: #6a6ad2;\n    }\n    .ivu-form-item{\n      margin-bottom: 24px;\n    }\n    .ivu-input-wrapper-large .ivu-input-icon{\n      line-height: 50px;\n    }\n    .loginInput input:nth-of-type(1){\n      height: 50px;  \n      font-size: 18px;\n      font-weight: bold;\n      font-family: Microsoft YaHei;\n      color: #333333;\n      line-height: 50px;\n    }\n    .ivu-input-large{\n      height: 50px;  \n      color:#CFCFCF;\n      line-height: 50px;\n    }\n    .ivu-input-large{\n      font-size: 14px;\n    }\n    .ivu-btn-large{\n      height: 50px;\n    }\n    .form {\n      padding-top: 2vh;\n      .input-verify {\n        width: 67%;\n      }\n    }\n    .code-image {\n      .ivu-spin-fix .ivu-spin-main {\n        height: 20px;\n      }\n    }\n    .forget-pass,\n    .other-way {\n      font-size: 14px;\n    }\n    .login-btn,\n    .other-login {\n      margin-top: 40px;\n    }\n    .icons {\n      display: flex;\n      align-items: center;\n    }\n    .other-icon {\n      cursor: pointer;\n      margin-left: 10px;\n      display: flex;\n      align-items: center;\n      color: rgba(0, 0, 0, .2);\n      :hover {\n        color: #2d8cf0;\n      }\n    }\n    .layout {\n      display: flex;\n      flex-direction: column;\n      justify-content: space-between;\n      width: 368px;\n      height: 100%;\n    }\n  }\n  </style>\n  "],"mappings":"AAiFA,SACAA,KAAA,EACAC,QAAA,EACAC,WAAA,EACAC,aAAA,QACA;AACA,OAAAC,OAAA;AACA,OAAAC,IAAA;AACA;EACAC,UAAA,GACA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,SAAA;MACAC,UAAA;MACAC,cAAA;MACAC,KAAA;MACAC,OAAA;MACAC,SAAA;MACAC,OAAA;MACAC,IAAA;QACAC,QAAA;QACAC,QAAA;QACAC,MAAA;QACAC,IAAA;MACA;MACAC,sBAAA;QACAJ,QAAA;UACAK,QAAA;UACAC,OAAA;UACAC,OAAA;QACA;QACAN,QAAA;UACAI,QAAA;UACAC,OAAA;UACAC,OAAA;QACA;QACAC,OAAA;UACAH,QAAA;UACAC,OAAA;UACAC,OAAA;QACA;MACA;IACA;EACA;EACAE,OAAA;IACAC,cAAA;MACA,KAAAhB,cAAA;MACAT,WAAA,GAAA0B,IAAA,CAAAC,GAAA;QACA,KAAAlB,cAAA;QACA,IAAAkB,GAAA,CAAAC,OAAA;UACA,KAAArB,SAAA,GAAAoB,GAAA,CAAAE,MAAA;UACA,KAAArB,UAAA,GAAAP,aAAA,QAAAM,SAAA;QACA;MACA;IACA;IACAuB,cAAAC,CAAA;MACA,IAAAA,CAAA;QACAC,MAAA,CAAAC,OAAA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;IACA;IACAC,WAAAP,GAAA;MACA,IAAAQ,WAAA,GAAAR,GAAA,CAAAE,MAAA;MACA,KAAAO,QAAA,gBAAAD,WAAA;MACApC,QAAA,GAAA2B,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,OAAA;UACA,OAAAD,GAAA,CAAAE,MAAA,CAAAQ,WAAA;UACA,IAAAC,KAAA;UACAX,GAAA,CAAAE,MAAA,CAAAS,KAAA,CAAAC,OAAA,CAAAR,CAAA;YACAO,KAAA,CAAAE,IAAA,CAAAT,CAAA,CAAAU,IAAA;UACA;UACA,OAAAd,GAAA,CAAAE,MAAA,CAAAS,KAAA;UACA,KAAAF,QAAA,UAAAE,KAAA;UACA,KAAAF,QAAA,mBAAAxB,SAAA;UACA,SAAAA,SAAA;YACAV,OAAA,CAAAwC,GAAA,aAAAC,IAAA,CAAAC,SAAA,CAAAjB,GAAA,CAAAE,MAAA;cACAgB,OAAA;YACA;UACA;YACA3C,OAAA,CAAAwC,GAAA,aAAAC,IAAA,CAAAC,SAAA,CAAAjB,GAAA,CAAAE,MAAA;UACA;UACA,KAAAO,QAAA,aAAAT,GAAA,CAAAE,MAAA;UACA,KAAAiB,MAAA,CAAAC,MAAA,kBAAApB,GAAA,CAAAE,MAAA,CAAAmB,MAAA;UACA7C,IAAA,CAAA8C,UAAA;UACA,KAAAC,OAAA,CAAAV,IAAA;YACAC,IAAA;UACA;QACA;UACA,KAAA5B,OAAA;QACA;MACA;IACA;IACAsC,YAAA;MACA,KAAAC,KAAA,CAAAC,iBAAA,CAAAC,QAAA,CAAAC,KAAA;QACA,IAAAA,KAAA;UACA,KAAA1C,OAAA;UACAf,KAAA;YACAiB,QAAA,OAAAD,IAAA,CAAAC,QAAA;YACAC,QAAA,OAAAF,IAAA,CAAAE,QAAA;YACAE,IAAA,OAAAJ,IAAA,CAAAS,OAAA;YACAhB,SAAA,OAAAA,SAAA;YACAK,SAAA,OAAAA;UACA,GAAAc,IAAA,CAAAC,GAAA;YACA,IAAAA,GAAA,CAAAC,OAAA;cACA,KAAAM,UAAA,CAAAP,GAAA;YACA;cACA,KAAAd,OAAA;cACA,KAAAY,aAAA;YACA;UACA;QACA;MACA;IACA;EACA;EACA+B,QAAA;IACA,KAAA/B,aAAA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}