{"ast":null,"code":"export default {\n  name: \"tagsPageOpened\",\n  data() {\n    return {\n      currentPageName: this.$route.name,\n      tagBodyLeft: 0,\n      refsTag: [],\n      tagsCount: 1\n    };\n  },\n  props: {\n    pageTagsList: Array,\n    beforePush: {\n      type: Function,\n      default: item => {\n        return true;\n      }\n    }\n  },\n  computed: {\n    title() {\n      return this.$store.state.app.currentTitle;\n    },\n    tagsList() {\n      return this.$store.state.app.pageOpenedList;\n    }\n  },\n  methods: {\n    itemTitle(item) {\n      if (item.name == \"home_index\") {\n        return \"Home\";\n      }\n      return item.title;\n    },\n    closePage(event, name) {\n      let pageOpenedList = this.$store.state.app.pageOpenedList;\n      let lastPageObj = pageOpenedList[0];\n      if (this.currentPageName == name) {\n        let len = pageOpenedList.length;\n        for (let i = 1; i < len; i++) {\n          if (pageOpenedList[i].name == name) {\n            if (i < len - 1) {\n              lastPageObj = pageOpenedList[i + 1];\n            } else {\n              lastPageObj = pageOpenedList[i - 1];\n            }\n            break;\n          }\n        }\n      } else {\n        let tagWidth = event.target.parentNode.offsetWidth;\n        this.tagBodyLeft = Math.min(this.tagBodyLeft + tagWidth, 0);\n      }\n      this.$store.commit(\"removeTag\", name);\n      this.$store.commit(\"closePage\", name);\n      pageOpenedList = this.$store.state.app.pageOpenedList;\n      localStorage.pageOpenedList = JSON.stringify(pageOpenedList);\n      if (this.currentPageName == name) {\n        this.linkTo(lastPageObj);\n      }\n    },\n    linkTo(item) {\n      if (this.$route.name == item.name) {\n        return;\n      }\n      let routerObj = {};\n      routerObj.name = item.name;\n      if (item.argu) {\n        routerObj.params = item.argu;\n      }\n      if (item.query) {\n        routerObj.query = item.query;\n      }\n      if (this.beforePush(item)) {\n        this.$router.push(routerObj);\n      }\n    },\n    handlescroll(e) {\n      var type = e.type;\n      let delta = 0;\n      if (type == \"DOMMouseScroll\" || type == \"mousewheel\") {\n        delta = e.wheelDelta ? e.wheelDelta : -(e.detail || 0) * 40;\n      }\n      let left = 0;\n      if (delta > 0) {\n        left = Math.min(0, this.tagBodyLeft + delta);\n      } else {\n        if (this.$refs.scrollCon.offsetWidth - 100 < this.$refs.scrollBody.offsetWidth) {\n          if (this.tagBodyLeft < -(this.$refs.scrollBody.offsetWidth - this.$refs.scrollCon.offsetWidth + 100)) {\n            left = this.tagBodyLeft;\n          } else {\n            left = Math.max(this.tagBodyLeft + delta, this.$refs.scrollCon.offsetWidth - this.$refs.scrollBody.offsetWidth - 100);\n          }\n        } else {\n          this.tagBodyLeft = 0;\n        }\n      }\n      this.tagBodyLeft = left;\n    },\n    handleTagsOption(type) {\n      if (type == \"clearAll\") {\n        this.$store.commit(\"clearAllTags\");\n        this.$router.push({\n          name: \"home_index\"\n        });\n      } else {\n        this.$store.commit(\"clearOtherTags\", this);\n      }\n      this.tagBodyLeft = 0;\n    },\n    moveToView(tag) {\n      if (tag.offsetLeft < -this.tagBodyLeft) {\n        // Tag is on the left side of the visible area\n        this.tagBodyLeft = -tag.offsetLeft + 10;\n      } else if (tag.offsetLeft + 10 > -this.tagBodyLeft && tag.offsetLeft + tag.offsetWidth < -this.tagBodyLeft + this.$refs.scrollCon.offsetWidth - 100) {\n        // Tag is in the visible area\n        this.tagBodyLeft = Math.min(0, this.$refs.scrollCon.offsetWidth - 100 - tag.offsetWidth - tag.offsetLeft - 20);\n      } else {\n        // Tag is on the right side of the visible area\n        this.tagBodyLeft = -(tag.offsetLeft - (this.$refs.scrollCon.offsetWidth - 100 - tag.offsetWidth) + 20);\n      }\n    }\n  },\n  mounted() {\n    this.refsTag = this.$refs.tagsPageOpened;\n    setTimeout(() => {\n      this.refsTag.forEach((item, index) => {\n        if (this.$route.name == item.name) {\n          let tag = this.refsTag[index].$el;\n          this.moveToView(tag);\n        }\n      });\n    }, 1); // Adding a timeout here to prevent offset bug\n    this.tagsCount = this.tagsList.length;\n  },\n  watch: {\n    $route(to) {\n      this.currentPageName = to.name;\n      this.$nextTick(() => {\n        this.refsTag.forEach((item, index) => {\n          if (to.name == item.name) {\n            let tag = this.refsTag[index].$el;\n            this.moveToView(tag);\n          }\n        });\n      });\n      this.tagsCount = this.tagsList.length;\n    }\n  }\n};","map":{"version":3,"names":["name","data","currentPageName","$route","tagBodyLeft","refsTag","tagsCount","props","pageTagsList","Array","beforePush","type","Function","default","item","computed","title","$store","state","app","currentTitle","tagsList","pageOpenedList","methods","itemTitle","closePage","event","lastPageObj","len","length","i","tagWidth","target","parentNode","offsetWidth","Math","min","commit","localStorage","JSON","stringify","linkTo","routerObj","argu","params","query","$router","push","handlescroll","e","delta","wheelDelta","detail","left","$refs","scrollCon","scrollBody","max","handleTagsOption","moveToView","tag","offsetLeft","mounted","tagsPageOpened","setTimeout","forEach","index","$el","watch","to","$nextTick"],"sources":["src/views/main-components/tags-page-opened.vue"],"sourcesContent":["<style lang=\"less\">\n@import \"../main.less\";\n</style>\n\n<template>\n<div ref=\"scrollCon\" @DOMMouseScroll=\"handlescroll\" @mousewheel=\"handlescroll\" class=\"tags-outer-scroll-con\">\n    <div class=\"close-all-tag-con\">\n        <Dropdown transfer @on-click=\"handleTagsOption\">\n            <Button size=\"small\" type=\"primary\">\n                Close Menu\n                <Icon type=\"md-arrow-dropdown\"></Icon>\n            </Button>\n            <DropdownMenu slot=\"list\">\n                <DropdownItem name=\"clearAll\">Close All</DropdownItem>\n                <DropdownItem name=\"clearOthers\">Close Others</DropdownItem>\n            </DropdownMenu>\n        </Dropdown>\n    </div>\n    <div ref=\"scrollBody\" class=\"tags-inner-scroll-body\" :style=\"{left: tagBodyLeft + 'px'}\">\n        <transition-group name=\"taglist-moving-animation\">\n            <Tag type=\"dot\" v-for=\"(item, index) in pageTagsList\" ref=\"tagsPageOpened\" :key=\"item.name\" :name=\"item.name\" @on-close=\"closePage\" @click.native=\"linkTo(item)\" :closable=\"item.name=='home_index'?false:true\" :color=\"item.children?(item.children[0].name==currentPageName?'primary':'default'):(item.name==currentPageName?'primary':'default')\">{{ item.title }}</Tag>\n        </transition-group>\n    </div>\n</div>\n</template>\n\n<script>\nexport default {\n    name: \"tagsPageOpened\",\n    data() {\n        return {\n            currentPageName: this.$route.name,\n            tagBodyLeft: 0,\n            refsTag: [],\n            tagsCount: 1\n        };\n    },\n    props: {\n        pageTagsList: Array,\n        beforePush: {\n            type: Function,\n            default: item => {\n                return true;\n            }\n        }\n    },\n    computed: {\n        title() {\n            return this.$store.state.app.currentTitle;\n        },\n        tagsList() {\n            return this.$store.state.app.pageOpenedList;\n        }\n    },\n    methods: {\n        itemTitle(item) {\n            if (item.name == \"home_index\") {\n                return \"Home\";\n            }\n            return item.title;\n        },\n        closePage(event, name) {\n            let pageOpenedList = this.$store.state.app.pageOpenedList;\n            let lastPageObj = pageOpenedList[0];\n            if (this.currentPageName == name) {\n                let len = pageOpenedList.length;\n                for (let i = 1; i < len; i++) {\n                    if (pageOpenedList[i].name == name) {\n                        if (i < len - 1) {\n                            lastPageObj = pageOpenedList[i + 1];\n                        } else {\n                            lastPageObj = pageOpenedList[i - 1];\n                        }\n                        break;\n                    }\n                }\n            } else {\n                let tagWidth = event.target.parentNode.offsetWidth;\n                this.tagBodyLeft = Math.min(this.tagBodyLeft + tagWidth, 0);\n            }\n            this.$store.commit(\"removeTag\", name);\n            this.$store.commit(\"closePage\", name);\n            pageOpenedList = this.$store.state.app.pageOpenedList;\n            localStorage.pageOpenedList = JSON.stringify(pageOpenedList);\n            if (this.currentPageName == name) {\n                this.linkTo(lastPageObj);\n            }\n        },\n        linkTo(item) {\n            if (this.$route.name == item.name) {\n                return;\n            }\n            let routerObj = {};\n            routerObj.name = item.name;\n            if (item.argu) {\n                routerObj.params = item.argu;\n            }\n            if (item.query) {\n                routerObj.query = item.query;\n            }\n            if (this.beforePush(item)) {\n                this.$router.push(routerObj);\n            }\n        },\n        handlescroll(e) {\n            var type = e.type;\n            let delta = 0;\n            if (type == \"DOMMouseScroll\" || type == \"mousewheel\") {\n                delta = e.wheelDelta ? e.wheelDelta : -(e.detail || 0) * 40;\n            }\n            let left = 0;\n            if (delta > 0) {\n                left = Math.min(0, this.tagBodyLeft + delta);\n            } else {\n                if (\n                    this.$refs.scrollCon.offsetWidth - 100 <\n                    this.$refs.scrollBody.offsetWidth\n                ) {\n                    if (\n                        this.tagBodyLeft <\n                        -(\n                            this.$refs.scrollBody.offsetWidth -\n                            this.$refs.scrollCon.offsetWidth +\n                            100\n                        )\n                    ) {\n                        left = this.tagBodyLeft;\n                    } else {\n                        left = Math.max(\n                            this.tagBodyLeft + delta,\n                            this.$refs.scrollCon.offsetWidth -\n                            this.$refs.scrollBody.offsetWidth -\n                            100\n                        );\n                    }\n                } else {\n                    this.tagBodyLeft = 0;\n                }\n            }\n            this.tagBodyLeft = left;\n        },\n        handleTagsOption(type) {\n            if (type == \"clearAll\") {\n                this.$store.commit(\"clearAllTags\");\n                this.$router.push({\n                    name: \"home_index\"\n                });\n            } else {\n                this.$store.commit(\"clearOtherTags\", this);\n            }\n            this.tagBodyLeft = 0;\n        },\n        moveToView(tag) {\n            if (tag.offsetLeft < -this.tagBodyLeft) {\n                // Tag is on the left side of the visible area\n                this.tagBodyLeft = -tag.offsetLeft + 10;\n            } else if (\n                tag.offsetLeft + 10 > -this.tagBodyLeft &&\n                tag.offsetLeft + tag.offsetWidth <\n                -this.tagBodyLeft + this.$refs.scrollCon.offsetWidth - 100\n            ) {\n                // Tag is in the visible area\n                this.tagBodyLeft = Math.min(\n                    0,\n                    this.$refs.scrollCon.offsetWidth -\n                    100 -\n                    tag.offsetWidth -\n                    tag.offsetLeft -\n                    20\n                );\n            } else {\n                // Tag is on the right side of the visible area\n                this.tagBodyLeft = -(\n                    tag.offsetLeft -\n                    (this.$refs.scrollCon.offsetWidth - 100 - tag.offsetWidth) +\n                    20\n                );\n            }\n        }\n    },\n    mounted() {\n        this.refsTag = this.$refs.tagsPageOpened;\n        setTimeout(() => {\n            this.refsTag.forEach((item, index) => {\n                if (this.$route.name == item.name) {\n                    let tag = this.refsTag[index].$el;\n                    this.moveToView(tag);\n                }\n            });\n        }, 1); // Adding a timeout here to prevent offset bug\n        this.tagsCount = this.tagsList.length;\n    },\n    watch: {\n        $route(to) {\n            this.currentPageName = to.name;\n            this.$nextTick(() => {\n                this.refsTag.forEach((item, index) => {\n                    if (to.name == item.name) {\n                        let tag = this.refsTag[index].$el;\n                        this.moveToView(tag);\n                    }\n                });\n            });\n            this.tagsCount = this.tagsList.length;\n        }\n    }\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}